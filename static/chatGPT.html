<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>MyAIChat</title>
    <script src="https://cdn.jsdelivr.net/npm/vue@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios@1.6.7/dist/axios.min.js"></script>
</head>

<body>
    <div id="app">
        apiKey<input v-model="chatGPTData.apiKey"><br>
        <textarea cols="20" rows="5">gpt-4.1-nano
gpt-4o-mini
gpt-4.1-mini
gpt-4.1</textarea><br>
        model<input v-model="chatGPTData.model"><br>
        temperature<input v-model="chatGPTData.temperature"><br>
        max_tokens<input v-model="chatGPTData.max_tokens"><br>
        top_p<input v-model="chatGPTData.top_p"><br>
        frequency_penalty<input v-model="chatGPTData.frequency_penalty"><br>
        presence_penalty<input v-model="chatGPTData.presence_penalty"><br>
        system<br>
        <textarea cols="30" rows="5" v-model="chatGPTData.headData[0].content[0].text"></textarea><br>
        inputMessage<br>
        <textarea cols="30" rows="5" v-model="chatGPTData.inputMessage"></textarea><button
            @click="sendAsync">send</button>
        <hr>
        messages<br>
        <template v-for="(message, messageIdx) in chatGPTData.messages" :key="messageIdx">
            <textarea cols="30" rows="5" v-model="message.req"></textarea>
            <textarea cols="30" rows="5" v-model="message.res"></textarea><br>
        </template>
    </div>
    <script>



        const vm = new Vue({
            el: "#app",
            data: {
                chatGPTData: {
                    apiKey: "",
                    headData: [
                        {
                            "role": "system",
                            "content": [
                                {
                                    "type": "text",
                                    "text": ""
                                }
                            ]
                        }
                    ],
                    model: "gpt-4.1-nano",
                    temperature: 0.8,
                    max_tokens: 256,
                    top_p: 1,
                    frequency_penalty: 0,
                    presence_penalty: 0,
                    inputMessage: "",
                    messages: []
                }
            },
            mounted() {
                const urlParams = new URLSearchParams(window.location.search);
                this.chatGPTData.apiKey = urlParams.get("apiKey");
                const system1 = urlParams.get("system1");
                if (system1) {
                    this.chatGPTData.headData[0].content[0].text = system1;
                }
            },
            methods: {
                getAuthorization() {
                    return `Bearer ${this.chatGPTData.apiKey}`;
                },
                async sendAsync() {
                    const req = this.chatGPTData.inputMessage;
                    this.chatGPTData.inputMessage = "...";

                    const reqData = {
                        model: this.chatGPTData.model,
                        messages: this.chatGPTData.headData.concat({
                            role: "user",
                            content: [
                                {
                                    type: "text",
                                    text: req
                                }
                            ]
                        }),
                        temperature: this.chatGPTData.temperature,
                        max_tokens: this.chatGPTData.max_tokens,
                        top_p: this.chatGPTData.top_p,
                        frequency_penalty: this.chatGPTData.frequency_penalty,
                        presence_penalty: this.chatGPTData.presence_penalty,
                    };

                    const res = await axios({
                        method: "post",
                        url: "https://api.openai.com/v1/chat/completions",
                        headers: {
                            "Content-Type": "application/json",
                            "Authorization": this.getAuthorization()
                        },
                        data: JSON.stringify(reqData)
                    });

                    this.chatGPTData.inputMessage = "";

                    this.chatGPTData.messages.unshift({
                        req: req,
                        res: res.data.choices.map(c => c.message?.content).reduce((a, c) => `${a}${c} `, "")
                    });
                }
            }
        });
    </script>
</body>

</html>